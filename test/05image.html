<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <!--<meta name="viewport" content="width=device-width, initial-scale=1">-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <title>VolcanoJS Image Test</title>
    <script src="http://zeptojs.com/zepto.js"></script>
    <script src="http://underscorejs.org/underscore.js"></script>
    <script src="http://backbonejs.org/backbone.js"></script>
    <script src="../src/exlibs/Ticker.js"></script>
    <script src="../src/core/Core.js"></script>
    <script src="../src/core/VObject.js"></script>
    <script src="../src/core/VSprite.js"></script>
    <script src="../src/core/UIComponent.js"></script>
    <script src="../src/managers/SystemManager.js"></script>
    <script src="../src/managers/LayoutManager.js"></script>
    <script src="../src/utils/ColorUtil.js"></script>
    <script src="../src/controls/Image.js"></script>
    <!--<script src="../lib/volcanojs.js"></script>-->
    <!--<script src="render.js"></script>-->
    <!--<script src="../src/exlibs/zynga/scroller/Scroller.js"></script>-->
    <!--<script src="../src/exlibs/zynga/scroller/Animate.js"></script>-->
    <!--<script src="../src/exlibs/zynga/scroller/EasyScroller.js"></script>-->
    <script src="../src/exlibs/greensock/src/uncompressed/TweenLite.js"></script>
    <script src="../src/exlibs/greensock/src/uncompressed/plugins/CSSPlugin.js"></script>
    <script src="../src/exlibs/iscroll/src/iscroll.js"></script>
    <script src="Stats.js"></script>

    <script>

        var a,b = {};
        var sysMgr, scroller, container;
        function onLoadHandler() {
//            volcano.VObject.randomColorMode = true;
            sysMgr = new volcano.SystemManager();
            sysMgr.frameRate(60);
            sysMgr.addEventListener("click", function(e) {
                a = e;
                _.extend(b,e);
                //console.log("target : "+e.target.getId()+ " , currentTarget : "+e.currentTarget.getId());
//                console.log(e);
            });

//            var application = new volcano.UIComponent().name("application").percentWidth(100).percentHeight(100);
            stats = new Stats();
            sysMgr.addElement(new volcano.VObject(stats.domElement));
            sysMgr.addEnterFrameListener(function(){stats.update()});



            container = new volcano.UIComponent().x(100).width(600).percentHeight(100).id("container");
            scroller = new volcano.UIComponent().percentWidth(100).height(1400).id("scroller");
            scroller.addEventListener("creationComplete",OnScrollerCreationComplete);
            sysMgr.addElement(container);
            container.addElement(scroller);
            console.log("top");
        };

        OnScrollerCreationComplete = function(event){
            console.log("bottom");
            new iScroll("container");
            volcano.Image.DEFAULT_ERR_IMGAGE = "img/noimg.jpg";
            for (var i=0; i<20; i++) {
                var width = 200;
                var height = 200;
                var regRowCnt = i%3;
                var regColCnt = Math.floor(i/3);
                var gapY = 20;
                var regX = regRowCnt * width;
                var regY = regColCnt * height;
                var img = new volcano.Image().id("img"+i).rotationY(180).z(-600).width(width).height(height).x(regX).y(regY - gapY).visible(false).alpha(0).source("http://jindo.dev.naver.com/docs/jindo-mobile/archive/latest/sample/latest/im/movie_image("+i+").jpg");
                if (i == 18) img.errorImg("img/noimg.gif");

                //if (i==19) { setScroll = function() { new iScroll("container"); };}                if (i==19)
                scroller.addElement(img);
                TweenLite.to(img,.5,{y:regY, rotationY:0, z:0, alpha:1, delay:0.1*i, ease:Quad.easeOut, onStart:function(target){
                    target.visible(true);
//                    console.log(target);
                },onStartParams:[img]});
            }



        }


    </script>
</head>

<body onload="onLoadHandler()" style="margin: 0px; padding: 0px;">
<div id="console"></div>
<div id="wrapper"></div>
</body>
</html>
